{% extends "base.html" %}

{% block title %}Dashboard - Flood Warning System{% endblock %}

{% block content %}
<div class="container-fluid py-3 py-md-5">
    <div class="row">
        <div class="col-lg-10 mx-auto">
            <div class="text-center mb-4 mb-md-5">
                <h2 class="fw-bold mb-2 mb-md-3" style="font-size: clamp(1.5rem, 5vw, 2rem);">Welcome, {{ user.username }}</h2>
                <p class="lead text-muted" style="font-size: clamp(0.875rem, 2vw, 1.125rem);">
                    {% if user.role == 'authority' %}
                        <span class="badge bg-warning text-dark me-2">Administrator</span>
                        You have full access to all dashboards
                    {% else %}
                        Resident Dashboard - Report floods and view risk map
                    {% endif %}
                </p>
            </div>

            <div class="row g-3 g-md-4">
                <!-- Map View Card -->
                <div class="col-md-4">
                    <div class="card shadow-lg h-100 border-0" style="cursor: pointer; transition: transform 0.3s ease;">
                        <div class="card-body p-3 p-md-4 text-center">
                            <div class="mb-3">
                                <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #0d6efd, #0056b3); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" viewBox="0 0 16 16">
                                        <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
                                    </svg>
                                </div>
                            </div>
                            <h4 class="card-title fw-bold mb-2 mb-md-3" style="font-size: clamp(1rem, 3vw, 1.25rem);">Flood Risk Map</h4>
                            <p class="card-text text-muted mb-3" style="font-size: clamp(0.8rem, 2vw, 0.9rem);">
                                View interactive flood risk map with heatmaps and real-time ward data.
                            </p>
                            <a href="{% url 'map' %}" class="btn btn-primary w-100" style="min-height: 44px;">
                                Open Map
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Flood History Card -->
                <div class="col-md-4">
                    <div class="card shadow-lg h-100 border-0" style="cursor: pointer; transition: transform 0.3s ease;">
                        <div class="card-body p-3 p-md-4 text-center">
                            <div class="mb-3">
                                <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #17a2b8, #138496); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" viewBox="0 0 16 16">
                                        <path d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022l-.074.997zm2.004.45a7.003 7.003 0 0 0-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 0 0-.439-.27l.493-.87a8.025 8.025 0 0 1 .979.654l-.615.789a6.996 6.996 0 0 0-.418-.302zm1.834 1.79a6.99 6.99 0 0 0-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 0 0-.214-.468l.893-.45a7.976 7.976 0 0 1 .45 1.088l-.95.313a7.023 7.023 0 0 0-.179-.483zm.53 2.507a6.991 6.991 0 0 0-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 0 1-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 0 1-.401.432l-.707-.707z"/>
                                        <path d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0v1z"/>
                                        <path d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"/>
                                    </svg>
                                </div>
                            </div>
                            <h4 class="card-title fw-bold mb-2 mb-md-3" style="font-size: clamp(1rem, 3vw, 1.25rem);">Flood History</h4>
                            <p class="card-text text-muted mb-3" style="font-size: clamp(0.8rem, 2vw, 0.9rem);">
                                View historical flood events from 2015-2025.
                            </p>
                            <a href="{% url 'flood-information' %}" class="btn btn-info w-100" style="min-height: 44px;">
                                View History
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Submit Report Card -->
                <div class="col-md-4">
                    <div class="card shadow-lg h-100 border-0" style="cursor: pointer; transition: transform 0.3s ease;">
                        <div class="card-body p-3 p-md-4 text-center">
                            <div class="mb-3">
                                <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #28a745, #1e7e34); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" viewBox="0 0 16 16">
                                        <path d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5L14 4.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5h-2z"/>
                                        <path d="M8.5 6.5a.5.5 0 0 0-1 0v1.5H6a.5.5 0 0 0 0 1h1.5V10.5a.5.5 0 0 0 1 0V9H10a.5.5 0 0 0 0-1H8.5V6.5z"/>
                                    </svg>
                                </div>
                            </div>
                            <h4 class="card-title fw-bold mb-2 mb-md-3" style="font-size: clamp(1rem, 3vw, 1.25rem);">Submit Report</h4>
                            <p class="card-text text-muted mb-3" style="font-size: clamp(0.8rem, 2vw, 0.9rem);">
                                Report a flood with photos and location data.
                            </p>
                            <a href="{% url 'submit-report-page' %}" class="btn btn-success w-100" style="min-height: 44px;">
                                New Report
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            {% if user.role == 'authority' %}
            <!-- Admin Section -->
            <div class="row mt-4 mt-md-5">
                <div class="col-12">
                    <div class="card shadow-lg border-warning" style="border-width: 2px;">
                        <div class="card-header bg-warning text-dark">
                            <h5 class="mb-0 fw-bold">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="me-2" viewBox="0 0 16 16">
                                    <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
                                </svg>
                                Administration Panel
                            </h5>
                        </div>
                        <div class="card-body p-3 p-md-4">
                            <div class="row g-3">
                                <!-- Stats -->
                                <div class="col-6 col-md-3">
                                    <div class="text-center p-3 bg-light rounded">
                                        <h3 class="fw-bold text-primary mb-0">{{ total_reports }}</h3>
                                        <small class="text-muted">Total Reports</small>
                                    </div>
                                </div>
                                <div class="col-6 col-md-3">
                                    <div class="text-center p-3 bg-light rounded">
                                        <h3 class="fw-bold text-warning mb-0">{{ pending_reports }}</h3>
                                        <small class="text-muted">Pending</small>
                                    </div>
                                </div>
                                <div class="col-6 col-md-3">
                                    <div class="text-center p-3 bg-light rounded">
                                        <h3 class="fw-bold text-success mb-0">{{ validated_reports }}</h3>
                                        <small class="text-muted">Validated</small>
                                    </div>
                                </div>
                                <div class="col-6 col-md-3">
                                    <div class="text-center p-3 bg-light rounded">
                                        <h3 class="fw-bold text-danger mb-0">{{ rejected_reports }}</h3>
                                        <small class="text-muted">Rejected</small>
                                    </div>
                                </div>
                            </div>
                            
                            <hr class="my-4">
                            
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <a href="{% url 'authority-dashboard' %}" class="btn btn-warning btn-lg w-100 d-flex align-items-center justify-content-center" style="min-height: 50px;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="me-2" viewBox="0 0 16 16">
                                            <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
                                            <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
                                        </svg>
                                        Manage Reports
                                    </a>
                                </div>
                                <div class="col-md-6">
                                    <a href="{% url 'admin:index' %}" class="btn btn-dark btn-lg w-100 d-flex align-items-center justify-content-center" style="min-height: 50px;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="me-2" viewBox="0 0 16 16">
                                            <path d="M5 0a.5.5 0 0 1 .5.5V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2A2.5 2.5 0 0 1 14 4.5h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14a2.5 2.5 0 0 1-2.5 2.5v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14A2.5 2.5 0 0 1 2 11.5H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2A2.5 2.5 0 0 1 4.5 2V.5A.5.5 0 0 1 5 0zm-.5 3A1.5 1.5 0 0 0 3 4.5v7A1.5 1.5 0 0 0 4.5 13h7a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 11.5 3h-7zM5 6.5A1.5 1.5 0 0 1 6.5 5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5v-3zM6.5 6a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z"/>
                                        </svg>
                                        Django Admin
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
    .card {
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15) !important;
    }
    @media (max-width: 768px) {
        .card:active {
            transform: scale(0.98);
        }
    }
</style>
{% endblock %}